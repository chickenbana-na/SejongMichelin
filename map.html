<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>세종대 주변 맛집 지도</title>
    <script src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=2qz7uouu7w"></script>
    <style>
        #map {
            width: 100%;
            height: 600px;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        // 지도 초기화
        const map = new naver.maps.Map('map', {
            center: new naver.maps.LatLng(37.550848, 127.074607),
            zoom: 16
        });

        // JSON 파일 불러오기
        fetch('./places.json')
            .then(response => {
                if (!response.ok) throw new Error('JSON 파일을 불러올 수 없습니다.');
                return response.json();
            })
            .then(data => {
                // 중복 제거 및 유효성 검사
                const unique = new Map();
                const filtered = data.filter(place =>
                    place.name && !unique.has(place.name) && unique.set(place.name, true)
                );

                filtered.forEach(place => {
                    const marker = new naver.maps.Marker({
                        position: new naver.maps.LatLng(place.position[0], place.position[1]),
                        map: map,
                        title: `${place.name} (${place.type})`
                    });

                    const infoWindow = new naver.maps.InfoWindow({
                        content: `<div style="padding:5px;"><strong>${place.name}</strong><br>${place.type}</div>`
                    });

                    naver.maps.Event.addListener(marker, 'click', () => {
                        infoWindow.open(map, marker);
                    });
                });
            })
            .catch(error => {
                console.error('마커 로딩 실패:', error);
            });
    </script>
</body>
</html>
