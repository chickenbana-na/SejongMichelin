<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>돌림판</title>
<style>
  *{font-family:Pretendard,sans-serif;box-sizing:border-box;}
  body{background:#eef2f7;margin:0;height:100vh;display:flex;justify-content:center;align-items:center;}
  #container{text-align:center;position:relative;max-width:700px;}
  canvas{margin-top:1rem;transition:2s ease;border-radius:50%;background:#fff;}
  button{
    background:#fbb034;margin-top:1rem;padding:0.7rem 1.5rem;border:none;
    font-size:1.4rem;font-weight:700;border-radius:6px;cursor:pointer;
    transition:.2s background,.2s color;
  }
  button:active{background:#444;color:#fff;}
  #pointer{
    position:absolute;top:17%;left:47%;
    transform:translate(calc(-50% -200px),calc(-35px + 100px)) rotate(0deg);
    width:0;height:0;
    border-left:20px solid transparent;
    border-right:20px solid transparent;
    border-top:50px solid red;
    z-index:10;
  }
  #inputArea{margin-top:10px;}
  #menuInput{
    width:60%;padding:.5rem;font-size:1.1rem;border-radius:6px;border:1px solid #ccc;
    box-sizing:border-box;
  }
  #addBtn{
    padding:.6rem 1rem;margin-left:8px;font-size:1.1rem;border-radius:6px;
    border:none;background:#4caf50;color:#fff;cursor:pointer;
    transition:.2s background;
  }
  #addBtn:hover{background:#45a049;}
  #menuList{display:none;margin-top:10px;min-height:24px;font-size:1.1rem;color:#333;}
  #menuList span{
    display:inline-block;background:#fbb034;color:#fff;padding:4px 10px;border-radius:15px;
    margin:3px 5px 3px 0;user-select:none;
  }
</style>
</head>
<body>
<div id="container">
  <h2>메뉴를 하나씩 입력하고 추가하세요 (최대 20개)</h2>
  <div id="inputArea">
    <input id="menuInput" placeholder="메뉴 이름 입력 후 엔터 또는 추가 버튼 클릭" autocomplete="off" />
    <button id="addBtn">추가</button>
  </div>
  <div id="menuList"></div>
  <div id="pointer"></div>
  <canvas id="roulette" width="600" height="600"></canvas>
  <button id="spinBtn">돌리기</button>
</div>
<script>
  const canvas=document.getElementById("roulette"),
        ctx=canvas.getContext("2d"),
        menuInput=document.getElementById("menuInput"),
        addBtn=document.getElementById("addBtn"),
        menuList=document.getElementById("menuList"),
        spinBtn=document.getElementById("spinBtn");

  let menuItems=[],colors=[];

  const genColors=()=>menuItems.map(_=>`rgb(${100+Math.random()*155|0},${100+Math.random()*155|0},${100+Math.random()*155|0})`);

  function drawWheel(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    if(!menuItems.length)return;

    const cx=canvas.width/2, cy=canvas.height/2,
          arc=(Math.PI*2)/menuItems.length,
          startAngle=Math.PI/2;

    colors=genColors();

    menuItems.forEach((item,i)=>{
      const start=startAngle+arc*i,
            end=startAngle+arc*(i+1);
      ctx.beginPath();
      ctx.fillStyle=colors[i];
      ctx.moveTo(cx,cy);
      ctx.arc(cx,cy,cx,start,end);
      ctx.fill();
      ctx.closePath();

      const angle=startAngle+arc*(i+0.5);
      ctx.save();
      ctx.translate(cx+Math.cos(angle)*(cx-60),cy+Math.sin(angle)*(cy-60));
      ctx.rotate(angle+Math.PI/2);
      ctx.fillStyle="#fff";
      ctx.font="16px Pretendard,sans-serif";
      ctx.textAlign="center";
      ctx.textBaseline="middle";
      ctx.fillText(item,0,0);
      ctx.restore();
    });
  }

  function addMenuItem(){
    const val=menuInput.value.trim();
    if(!val)return alert("메뉴 이름을 입력하세요.");
    if(menuItems.length>=20)return alert("메뉴는 최대 20개까지 추가할 수 있습니다.");

    menuItems.push(val);
    menuInput.value="";
    drawWheel();
  }

  function spinWheel(){
    if(!menuItems.length)return alert("먼저 메뉴를 추가하세요!");
    canvas.style.transition="none";
    canvas.style.transform="rotate(0deg)";
    const anglePer=360/menuItems.length;
    const randomIndex=Math.floor(Math.random()*menuItems.length);
    const randomOffset=Math.random()*anglePer;
    const finalAngle=(randomIndex*anglePer)+3600+randomOffset;
    setTimeout(()=>{
      canvas.style.transition="2s ease";
      canvas.style.transform=`rotate(${finalAngle}deg)`;
    },20);
  }

  addBtn.onclick=addMenuItem;
  menuInput.onkeydown=e=>{if(e.key==="Enter"){e.preventDefault();addMenuItem();}};
  spinBtn.onclick=spinWheel;

  drawWheel();
</script>
</body>
</html>
